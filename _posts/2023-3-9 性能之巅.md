-   性能优化方法：包括响应时间和吞吐量优化，以及基准测试、容量规划、垂直和水平扩展等方面的优化方法。
-   系统架构设计：包括分层架构、微服务架构、事件驱动架构、云原生架构等，以及它们的优缺点和适用场景。
-   操作系统和计算机体系结构：包括CPU、内存、缓存、磁盘、网络等硬件和操作系统相关的知识，以及如何优化它们的性能。
-   数据库和存储系统：包括关系型数据库、NoSQL数据库、内存数据库、文件系统等，以及它们的优缺点和适用场景。
-   分布式系统：包括分布式存储、分布式计算、分布式事务等，以及如何处理分布式系统中的并发和一致性问题。
-   云计算和容器技术：包括公有云、私有云、混合云等云计算部署模型，以及Docker、Kubernetes等容器技术的基本概念和使用方法。
-   网络和协议：包括TCP/IP协议、HTTP协议、WebSocket协议等，以及如何诊断和优化网络问题。
-   性能工具和监控：包括负载测试工具、性能监控工具、日志分析工具等，以及如何使用这些工具来诊断和解决性能问题。
-   安全和可靠性：包括如何保证系统的可用性、可靠性和安全性，以及如何应对各种安全和可靠性威胁。
-   DevOps和敏捷开发：包括DevOps和敏捷开发的基本概念、实践和工具，以及如何将它们与性能优化和系统设计相结合。

第一部分：性能指标与性能分析

-   第1章：性能指标和性能评估
-   第2章：性能分析的基础
-   第3章：性能基准测试

第一部分的重点是关于性能测量的基本原理和工具，涵盖以下几个方面：

1.  性能测量的基本原理：Brendan Gregg在本书中介绍了性能测量的四个基本原则，即测量、分析、比较和验证[[1](https://www.cnblogs.com/Solstice/p/gregg.html)]。
    
2.  性能测量的基本工具：本书介绍了多种性能观测工具，包括计数器、跟踪器和剖析器等。其中，计数器是内核维护的统计数据，可以用于对事件计数[[3](https://blog.csdn.net/qq_23662505/article/details/119563743)]。
    
3.  火焰图：本书介绍了火焰图作为一种常用的性能分析工具，可以用于可视化代码的执行过程，并识别瓶颈[[2](https://zhuanlan.zhihu.com/p/73385693)]。
    
4.  其他工具和技术：本书还介绍了其他性能观测工具和技术，如dtrace、perf等，并提供了相应的实例和使用方法。
    

综上所述，第一部分主要介绍了性能测量的基本原理和工具，包括计数器、跟踪器和剖析器等，同时也介绍了火焰图作为一种常用的性能分析工具，以及其他工具和技术。

第二部分：系统性能

-   第4章：操作系统的性能
-   第5章：存储系统的性能
-   第6章：网络性能

第三部分：企业应用性能

-   第7章：企业应用性能基础
-   第8章：Java虚拟机性能
-   第9章：数据库性能
-   第10章：Web应用程序性能

第四部分：云计算性能

-   第11章：云计算的性能挑战
-   第12章：云服务的性能分析
-   第13章：云应用程序性能

第五部分：性能优化

-   第14章：系统和应用程序性能优化
-   第15章：云环境中的性能优化



频次最高的10个分析工具或命令：

1.  top：用于查看系统中运行的进程和资源占用情况的命令行工具。
    
2.  sar：系统活动报告工具，用于收集和报告系统资源使用情况的命令行工具。
    
3.  strace：用于跟踪进程系统调用和信号的命令行工具。
    
4.  tcpdump：用于捕获和分析网络数据包的命令行工具。
    
5.  Wireshark：网络协议分析工具，用于分析和调试网络通信的图形化工具。
    
6.  perf：Linux性能事件分析工具，用于分析CPU、内存和I/O等性能事件的命令行工具。
    
7.  lsof：列出打开文件的工具，用于显示系统中打开的文件和进程的命令行工具。
    
8.  ps：查看系统进程的命令行工具。
    
9.  iostat：输入/输出统计工具，用于监控系统磁盘和存储性能的命令行工具。
    
10.  vmstat：虚拟内存统计工具，用于监控系统内存和CPU使用情况的命令行工具。

# 综述

## 1.1 系统性能


 （图 1.1 系统性能-通用软件栈）
 
- 整个系统的研究：所有的硬件组件和整个软件栈。
- 所有数据路径、软硬件上所有的事情都会影响性能。
- 当讨论到系统性能，全栈表示所有事情，包括系统库及内核。
	“全栈”（entire stack）有时一般仅仅指的是应用程序环境，包括数据库、应用程序，以及网站服务器。”

## 1.2 人员与职能

- 一般人员配置都是兼职 对性能问题的解决，这样出现问题需要很多职能的人协作解决。
- 有的公司会请 性能工程师，其主要任务就是维护系统性能。
	- 他们与多个团队协同工作
	- 对环境做全局性的研究
	- 执行一些对解决复杂性能问题至关重要的操作。
	- 会开发更好的工具
	- 对整个环境做系统级分析（system-wide analysis）
	- 为容量规划（capacity planning）定义指标
- 性能工程师也有精细到应用程序（mysql性能工程师、java性能工程师等）的工种，通常他们在开始使用特定的应用程序工具之前，会做一些系统性能检查，但是有限。


## 1.3 性能领域的事情


（图 1.3 事情）

 1.设置性能目标和建立性能模型 
 2.基于软件或硬件原型进行性能特征归纳 
 3.对开发代码进行性能分析（软件整合之前） 
 4.执行软件非回归性测试（软件发布前或发布后） 
 5.针对软件发布版本的基准测试 
 6.目标环境中的概念验证（Proof-of-concept）测试 
 7.生产环境部署的配置优化 
 8.监控生产环境中运行的软件 
 9.特定问题的性能分析

- 1～5 常见的软件开发过程，这个阶段经常缺失性能设计，从而导致6～9节点在客户环境中出现“未知”的性能问题。
- 当没有性能设计参与的架构，后期出现的性能问题修复难度会越来越大。
- 因为缺乏设计，所以没有目标，没有目标，监控就容易丢失重心。
- 在设计阶段对开发软件的资源占用情况进行研究，得以进一步确认最初性能设计与性能目标的偏差程度。在部署后，监控资源的使用情况，可以在问题出现之前就被发现。
	容量规划（capacity planning）指的是一系列事前行动


## 1.4 视角


图 视角

	负载分析 （workload analysis） 一般系统管理员会从这个视角进行分析
	资源分析 （resource analysis） 一般开发人员会从这个视角进行分析


## 1.5 性能是充满挑战的


### 1.5.1 性能是主观的

- 已经存在的客观事实，在没有明确的期望性能目标时，很难断定其“好”或“坏”。
- 需要方法将性能客观化。

### 1.5.2 性能是复杂的

- 系统的复杂性，组件的关联。
- 常常缺少一个明确的分析起点。
- 瓶颈往往是复杂的，看似解决了瓶颈，可能只是将瓶颈推向了系统的其他地方，从而导致整体系统性能没有提升。
- 环境很难复现，或只能间歇式重现。

### 1.5.3 可能多个问题并存

- 成熟的软件，即便是那些被认为拥有高性能的软件，也会有不少已知的但未被修复的性能问题。
- 真正的任务不是寻找问题，而是辨别问题或者说是辨别哪些问题是最重要的。
- 识别“最重要的”，意味着性能分析要对问题的重要程度进行“量化”（quantify）。
- 理想情况：1. 量化问题 2. 估计每个问题修复后带来的增速。
- 延迟（latency）这个指标非常适合量化性能。

## 1.6 延迟 Latency

- 延迟 = 等待时间
- 广义：所有操作完成的等待时间
- 延迟可以估计最大增速（maximum speedup）。

## 1.7 动态跟踪 dynamic tracing


- 动态跟踪可以从任意感兴趣的点测量延迟（latency），并且提供数据以显示延迟完整的分布情况。
- dynamic tracing 可以把所有软件变得可以监控。
- 可以在真实的生产环境中使用。
- 比“内核分析”更方便的对延迟建立测量监控。
- Dtrace 对用户态和内核态的软件都提供了静态跟踪和动态跟踪